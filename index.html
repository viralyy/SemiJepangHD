<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SemiJepangHD</title>
  <meta name="color-scheme" content="dark" />
  <style>
    :root {
      --bg: #0b0c10;
      --panel: rgba(18,19,26,.92);
      --panel2: rgba(15,16,22,.95);
      --text: #e8e8ee;
      --muted: #a8a8b3;
      --stroke: rgba(255,255,255,.10);
      --shadow: 0 8px 32px rgba(0,0,0,.30);
      --accent1: rgba(255,0,80,.92);
      --accent2: rgba(120,90,255,.85);
      --danger: rgba(255,64,64,.95);
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      color: var(--text);
      background: var(--bg);
      background-image: 
        radial-gradient(ellipse at 20% 10%, rgba(255,0,80,0.10), transparent 60%),
        radial-gradient(ellipse at 80% 85%, rgba(120,90,255,0.08), transparent 60%);
      background-attachment: fixed;
      min-height: 100vh;
    }

    a { color: inherit; text-decoration: none; }

    .wrap { max-width: 1200px; margin: 0 auto; padding: 14px 14px 38px; }

    header {
      position: sticky;
      top: 0;
      z-index: 20;
      background: rgba(11,12,16, 0.94);
      padding: 10px 0 12px;
    }

    /* ... (sisa CSS sama seperti sebelumnya, gue skip biar ga panjang, copy dari kode lama kamu kalau perlu) ... */

  </style>
</head>
<body>

  <!-- Age Gate, Menu, Header, Footer â†’ copy dari kode lama kamu -->

  <main class="wrap">
    <div class="sectionHead">
      <h2 id="sectionTitle">Browse</h2>
      <div class="meta" id="metaInfo">Loading...</div>
    </div>

    <div class="grid" id="grid"></div>

    <!-- Pager dan Footer sama seperti sebelumnya -->
  </main>

  <script>
    const PAGE_SIZE = 15;

    let allPosts = [];
    let filtered = [];
    let currentId = null;

    let page = 0;
    let activeGenre = "All";
    let query = "";

    const grid = document.getElementById("grid");
    const metaInfo = document.getElementById("metaInfo");
    const sectionTitle = document.getElementById("sectionTitle");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");
    const searchBtn = document.getElementById("searchBtn");
    const searchRow = document.getElementById("searchRow");
    const searchInput = document.getElementById("searchInput");
    const clearFilterBtn = document.getElementById("clearFilterBtn");
    const menuBtn = document.getElementById("menuBtn");
    const menuPanel = document.getElementById("menuPanel");
    const menuBackdrop = document.getElementById("menuBackdrop");
    const menuClose = document.getElementById("menuClose");
    const genreList = document.getElementById("genreList");

    document.getElementById("year").textContent = new Date().getFullYear();

    function esc(s) {
      return String(s)
        .replaceAll("&", "&")
        .replaceAll("<", "<")
        .replaceAll(">", ">")
        .replaceAll('"', """)
        .replaceAll("'", "'");
    }

    async function apiGet(path) {
      const res = await fetch(path, { cache: "no-store" });
      if (!res.ok) return null;
      return res.json();
    }

    function getText(post) {
      return ((post.title || "") + " " + (post.genre || "") + " " + (post.description || "")).toLowerCase();
    }

    function applyFilter() {
      const q = query.trim().toLowerCase();
      filtered = allPosts.filter(p => {
        const gOk = activeGenre === "All" || (p.genre || "").toLowerCase() === activeGenre.toLowerCase();
        const qOk = !q || getText(p).includes(q);
        return gOk && qOk;
      });
      page = 0;
      render();
      renderGenres();
    }

    function render() {
      const total = filtered.length;
      const maxPage = Math.max(0, Math.ceil(total / PAGE_SIZE) - 1);
      page = Math.min(page, maxPage);

      const start = page * PAGE_SIZE;
      const end = Math.min(start + PAGE_SIZE, total);
      const items = filtered.slice(start, end);

      sectionTitle.textContent = activeGenre === "All" ? "Browse" : `Genre: ${activeGenre}`;
      metaInfo.textContent = total ? `Showing \( {start+1}- \){end} of ${total}` : "No posts";

      prevBtn.setAttribute("aria-disabled", page === 0);
      nextBtn.setAttribute("aria-disabled", page >= maxPage);

      grid.innerHTML = "";

      items.forEach(p => {
        const minutes = p.durationMinutes ?? p.minutes ?? p.duration ?? null;
        const genre = p.genre || "-";

        const card = document.createElement("a");
        card.className = "card";
        card.href = `/player.html?id=${encodeURIComponent(p.id || "")}`;

        const featuredBadge = (p.id && currentId && p.id === currentId)
          ? '<span style="margin-left:8px; font-size:11px; color:rgba(255,255,255,.78)">Featured</span>'
          : "";

        card.innerHTML = `
<div class="thumb">
  <img src="\( {esc(p.poster || 'https://via.placeholder.com/900x1600?text=Poster')}" alt=" \){esc(p.title || 'Poster')}" loading="lazy">
  <div class="thumbOverlay">
    <div class="playPill">
      <svg viewBox="0 0 24 24" fill="none"><path d="M10 8.5v7l7-3.5-7-3.5Z" stroke="rgba(255,255,255,.92)" stroke-width="1.8" stroke-linejoin="round"/></svg>
      <span>Play</span>
    </div>
    <div class="tTitle">\( {esc(p.title || "Untitled")} \){featuredBadge}</div>
  </div>
</div>

<div class="info">
  <div class="line1">
    <span class="tagMini">
      <svg viewBox="0 0 24 24" fill="none"><path d="M12 3.5c4.7 0 8.5 3.8 8.5 8.5S16.7 20.5 12 20.5 3.5 16.7 3.5 12 7.3 3.5 12 3.5Z" stroke="rgba(255,255,255,.92)" stroke-width="1.6"/><path d="M12 7.6v5.2l3.2 2" stroke="rgba(255,255,255,.92)" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
      <span>${minutes ? esc(String(minutes)) + " min" : "-"}</span>
    </span>
    <span class="tagMini">
      <svg viewBox="0 0 24 24" fill="none"><path d="M6.5 7.5h11M6.5 12h11M6.5 16.5h11" stroke="rgba(255,255,255,.92)" stroke-width="1.7" stroke-linecap="round"/></svg>
      <span>${esc(genre)}</span>
    </span>
  </div>

  <div class="playBtn" role="button" aria-label="Play">
    <svg viewBox="0 0 24 24" fill="none"><path d="M10 8.5v7l7-3.5-7-3.5Z" stroke="rgba(255,255,255,.92)" stroke-width="1.9" stroke-linejoin="round"/></svg>
    <span>Play</span>
  </div>
</div>
`;

        grid.appendChild(card);
      });
    }

    // Fungsi lain (collectGenres, renderGenres, openMenu, closeMenu, event listeners, boot, age gate) tetap sama seperti kode lama kamu
    // ... copy bagian itu dari kode asli kamu ...

    // Pastikan bagian boot() dipanggil setelah age gate
    if (shouldShowGate()) {
      ageGate.classList.add("show");
    } else {
      boot();
    }
  </script>
</body>
</html>
